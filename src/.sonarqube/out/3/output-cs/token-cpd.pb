ª"
ë/Users/guilhermelyracampos/Documents/profissional/projetos/git/rei-do-almoco/src/services/GL.ReiDoAlmoco.Infra.Data/Context/ReiDoAlmocoContext.cs
	namespace 	
GL
 
. 
ReiDoAlmoco 
. 
Infra 
. 
Data #
.# $
Context$ +
{ 
public 

class 
ReiDoAlmocoContext #
:$ %
	DbContext& /
{ 
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
public		 
ReiDoAlmocoContext		 !
(		! "
)		" #
{

 	
} 	
public 
ReiDoAlmocoContext !
(! "
IConfiguration" 0
configuration1 >
)> ?
{ 	
_configuration 
= 
configuration *
;* +
} 	
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
optionsBuilder 
. 
UseSqlServer '
(' (
$str	( å
)
å ç
;
ç é
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
var 
pretendente 
= 
modelBuilder *
.* +
Entity+ 1
<1 2
Pretendente2 =
>= >
(> ?
)? @
;@ A
pretendente 
. 
HasKey 
( 
p  
=>! #
p$ %
.% &
Id& (
)( )
;) *
pretendente 
. 
ToTable 
(  
$str  -
)- .
;. /
pretendente 
. 
Property  
(  !
p! "
=># %
p& '
.' (
Nome( ,
), -
.- .

IsRequired. 8
(8 9
)9 :
.: ;
HasColumnType; H
(H I
$strI X
)X Y
;Y Z
pretendente 
. 
Property  
(  !
p! "
=># %
p& '
.' (
Email( -
)- .
.. /

IsRequired/ 9
(9 :
): ;
.; <
HasColumnType< I
(I J
$strJ Y
)Y Z
;Z [
var 
voto 
= 
modelBuilder #
.# $
Entity$ *
<* +
Voto+ /
>/ 0
(0 1
)1 2
;2 3
voto 
. 
HasKey 
( 
p 
=> 
p 
. 
Id !
)! "
;" #
voto 
. 
ToTable 
( 
$str 
)  
;  !
voto   
.   
Property   
(   
p   
=>   
p    
.    !

Quantidade  ! +
)  + ,
.  , -

IsRequired  - 7
(  7 8
)  8 9
;  9 :
voto!! 
.!! 
Property!! 
(!! 
p!! 
=>!! 
p!!  
.!!  !
PretendenteId!!! .
)!!. /
.!!/ 0

IsRequired!!0 :
(!!: ;
)!!; <
;!!< =
voto"" 
."" 
Property"" 
("" 
p"" 
=>"" 
p""  
.""  !
Data""! %
)""% &
.""& '

IsRequired""' 1
(""1 2
)""2 3
;""3 4
}## 	
public%% 
DbSet%% 
<%% 
Pretendente%%  
>%%  !
Pretendentes%%" .
{%%/ 0
get%%1 4
;%%4 5
set%%6 9
;%%9 :
}%%; <
public&& 
DbSet&& 
<&& 
Voto&& 
>&& 
Votos&&  
{&&! "
get&&# &
;&&& '
set&&( +
;&&+ ,
}&&- .
}'' 
}(( á
ß/Users/guilhermelyracampos/Documents/profissional/projetos/git/rei-do-almoco/src/services/GL.ReiDoAlmoco.Infra.Data/Migrations/20191126130445_CriarTabelaPretendente.cs
	namespace 	
GL
 
. 
ReiDoAlmoco 
. 
Infra 
. 
Data #
.# $

Migrations$ .
{ 
public 

partial 
class "
CriarTabelaPretendente /
:0 1
	Migration2 ;
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
Nome 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Email 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 F
,F G
nullableH P
:P Q
falseR W
)W X
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str #
)# $
;$ %
} 	
} 
} π
ï/Users/guilhermelyracampos/Documents/profissional/projetos/git/rei-do-almoco/src/services/GL.ReiDoAlmoco.Infra.Data/Migrations/20191129124039_Voto.cs
	namespace 	
GL
 
. 
ReiDoAlmoco 
. 
Infra 
. 
Data #
.# $

Migrations$ .
{ 
public 

partial 
class 
Voto 
: 
	Migration  )
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
Data 
= 
table  
.  !
Column! '
<' (
DateTime( 0
>0 1
(1 2
nullable2 :
:: ;
false< A
)A B
,B C

Quantidade 
=  
table! &
.& '
Column' -
<- .
int. 1
>1 2
(2 3
nullable3 ;
:; <
false= B
)B C
,C D
PretendenteId !
=" #
table$ )
.) *
Column* 0
<0 1
Guid1 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% .
,. /
x0 1
=>2 4
x5 6
.6 7
Id7 9
)9 :
;: ;
table 
. 

ForeignKey $
($ %
name 
: 
$str A
,A B
column 
: 
x  !
=>" $
x% &
.& '
PretendenteId' 4
,4 5
principalTable &
:& '
$str( 5
,5 6
principalColumn '
:' (
$str) -
,- .
onDelete  
:  !
ReferentialAction" 3
.3 4
Cascade4 ;
); <
;< =
} 
) 
; 
migrationBuilder 
. 
CreateIndex (
(( )
name 
: 
$str -
,- .
table   
:   
$str   
,   
column!! 
:!! 
$str!! '
)!!' (
;!!( )
}"" 	
	protected$$ 
override$$ 
void$$ 
Down$$  $
($$$ %
MigrationBuilder$$% 5
migrationBuilder$$6 F
)$$F G
{%% 	
migrationBuilder&& 
.&& 
	DropTable&& &
(&&& '
name'' 
:'' 
$str'' 
)'' 
;'' 
}(( 	
})) 
}** â 
ö/Users/guilhermelyracampos/Documents/profissional/projetos/git/rei-do-almoco/src/services/GL.ReiDoAlmoco.Infra.Data/Repositories/PretendenteRepositorio.cs
	namespace		 	
GL		
 
.		 
ReiDoAlmoco		 
.		 
Infra		 
.		 
Data		 #
.		# $
Repositories		$ 0
{

 
public 

class "
PretendenteRepositorio '
:( )#
IPretendenteRepositorio* A
{ 
private 
readonly 
ReiDoAlmocoContext +
	_contexto, 5
;5 6
public "
PretendenteRepositorio %
(% &
ReiDoAlmocoContext& 8
contexto9 A
)A B
{ 	
	_contexto 
= 
contexto  
;  !
} 	
public 
async 
Task 
AdicionarAsync (
(( )
Pretendente) 4
pretendente5 @
)@ A
{ 	
await 
	_contexto 
. 
Pretendentes (
.( )
AddAsync) 1
(1 2
pretendente2 =
)= >
;> ?
await 
	_contexto 
. 
SaveChangesAsync ,
(, -
)- .
;. /
} 	
public 
async 
Task 
AtualizarAsync (
(( )
Pretendente) 4
pretendente5 @
)@ A
{ 	
	_contexto 
. 
Update 
( 
pretendente (
)( )
;) *
await 
	_contexto 
. 
SaveChangesAsync ,
(, -
)- .
;. /
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
Pretendente& 1
>1 2
>2 3
ListarAsync4 ?
(? @
)@ A
{ 	
return 
await 
	_contexto "
." #
Pretendentes# /
./ 0
ToArrayAsync0 <
(< =
)= >
;> ?
} 	
public!! 
async!! 
Task!! 
<!! 
Pretendente!! %
>!!% &

ObterAsync!!' 1
(!!1 2
Guid!!2 6
id!!7 9
)!!9 :
{"" 	
return## 
await## 
	_contexto## "
.##" #
Pretendentes### /
.##/ 0
	FindAsync##0 9
(##9 :
id##: <
)##< =
;##= >
}$$ 	
public&& 
async&& 
Task&& 
<&& 
Pretendente&& %
>&&% &
ObterPorEmailAsync&&' 9
(&&9 :
string&&: @
email&&A F
)&&F G
{'' 	
return(( 
await(( 
	_contexto(( "
.((" #
Pretendentes((# /
.)) 
FirstOrDefaultAsync)) (
())( )
p))) *
=>))+ -
p)). /
.))/ 0
Email))0 5
.))5 6
Equals))6 <
())< =
email))= B
)))B C
)))C D
;))D E
}** 	
public,, 
async,, 
Task,, 
RemoverAsync,, &
(,,& '
Guid,,' +
id,,, .
),,. /
{-- 	
var.. 
pretendente.. 
=.. 
await.. #

ObterAsync..$ .
(... /
id../ 1
)..1 2
;..2 3
if// 
(// 
pretendente// 
!=// 
null// "
)//" #
{00 
	_contexto11 
.11 
Pretendentes11 &
.11& '
Remove11' -
(11- .
pretendente11. 9
)119 :
;11: ;
await22 
	_contexto22 
.22  
SaveChangesAsync22  0
(220 1
)221 2
;222 3
}33 
}44 	
}55 
}66 Ï
ì/Users/guilhermelyracampos/Documents/profissional/projetos/git/rei-do-almoco/src/services/GL.ReiDoAlmoco.Infra.Data/Repositories/VotoRepositorio.cs
	namespace 	
GL
 
. 
ReiDoAlmoco 
. 
Infra 
. 
Data #
.# $
Repositories$ 0
{ 
public 

class 
VotoRepositorio  
:! "
IVotoRepositorio# 3
{ 
private 
readonly 
ReiDoAlmocoContext +
	_contexto, 5
;5 6
public 
VotoRepositorio 
( 
ReiDoAlmocoContext 1
contexto2 :
): ;
{ 	
	_contexto 
= 
contexto  
;  !
} 	
public 
async 
Task 
AdicionarAsync (
(( )
Voto) -
voto. 2
)2 3
{ 	
await 
	_contexto 
. 
Votos !
.! "
AddAsync" *
(* +
voto+ /
)/ 0
;0 1
await 
	_contexto 
. 
SaveChangesAsync ,
(, -
)- .
;. /
} 	
public 
async 
Task 
AtualizarAsync (
(( )
Voto) -
voto. 2
)2 3
{ 	
	_contexto 
. 
Votos 
. 
Update "
(" #
voto# '
)' (
;( )
await 
	_contexto 
. 
SaveChangesAsync ,
(, -
)- .
;. /
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
Voto& *
>* +
>+ ,
ListarAsync- 8
(8 9
)9 :
{   	
return!! 
await!! 
	_contexto!! "
.!!" #
Votos!!# (
.!!( )
Include!!) 0
(!!0 1
p!!1 2
=>!!3 5
p!!6 7
.!!7 8
Pretendente!!8 C
)!!C D
.!!D E
ToArrayAsync!!E Q
(!!Q R
)!!R S
;!!S T
}"" 	
public$$ 
async$$ 
Task$$ 
<$$ 
IEnumerable$$ %
<$$% &
Voto$$& *
>$$* +
>$$+ ,
ListarDoDiaAsync$$- =
($$= >
)$$> ?
{%% 	
return&& 
await&& 
	_contexto&& "
.&&" #
Votos&&# (
.&&( )
Where&&) .
(&&. /
p&&/ 0
=>&&1 3
p&&4 5
.&&5 6
Data&&6 :
.&&: ;
Date&&; ?
==&&@ B
DateTime&&C K
.&&K L
Today&&L Q
.&&Q R
Date&&R V
)&&V W
.&&W X
ToArrayAsync&&X d
(&&d e
)&&e f
;&&f g
}'' 	
public)) 
async)) 
Task)) 
<)) 
Voto)) 
>)) 

ObterDoDia))  *
())* +
Guid))+ /
pretendenteId))0 =
)))= >
{** 	
return++ 
await++ 
	_contexto++ "
.++" #
Votos++# (
.,,  !
Include,,! (
(,,( )
c,,) *
=>,,+ -
c,,. /
.,,/ 0
Pretendente,,0 ;
),,; <
.--  !
Where--! &
(--& '
p--' (
=>--) +
p--, -
.--- .
Data--. 2
.--2 3
Date--3 7
==--8 :
DateTime--; C
.--C D
Today--D I
.--I J
Date--J N
&&--O Q
p--R S
.--S T
PretendenteId--T a
==--b d
pretendenteId--e r
)--r s
...  !
FirstOrDefaultAsync..! 4
(..4 5
)..5 6
;..6 7
}// 	
}00 
}11 